name: "Sync `config.js` to Template Repository"

on:
  push:
    paths:
      - docs/config.js
      - .github/workflows/sync-config.js.yaml

jobs:
  sync-to-template-repo:
    name: "Sync `config.js` to Template Repository"

    runs-on: "ubuntu-latest"

    steps:
      - name: "Checkout Source Repository"
        uses: "actions/checkout@v3"
        with:
          repository: "${{ github.repository }}"
          path: "pn"

      - name: "Checkout Template Repository"
        uses: "actions/checkout@v3"
        with:
          repository: "jmuchovej/sync-paperpile-to-notion"
          path: "st"

      - name: "Sync `config.js` changes"
        shell: "bash"
        run: |
          cp ./pn/docs/config.js ./st/.config/paperpile-notion/config.js

      - name: "Commit Changes to Template Repository"
        shell: "bash"
        run: |
          cd ./st
          git config user.email "5000729+jmuchovej@users.noreply.github.com"
          git config user.name "John Muchovej"
          git add .config/paperpile-notion/config.js
          git commit -m "ðŸ”§ Update \`config.js\` to reflect latest release configuration"
          git push -u origin main
